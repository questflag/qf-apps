@page "/login/two-factor"
@using QuestFlag.Passport.UserClient
@inject PassportUserClient PassportClient
@inject NavigationManager Nav
@inject IJSRuntime JS

<PageTitle>Two-Factor Authentication — QuestFlag</PageTitle>

<div class="sso-container">
    <div class="sso-card">
        <div class="sso-header">
            <div class="brand-logo">QF</div>
            <h1 class="tenant-name">Verify It's You</h1>
            <p class="sign-in-subtitle">Enter the 6-digit code sent to your phone</p>
        </div>

        @if (_error != null) { <div class="error-banner">@_error</div> }

        <form @onsubmit="HandleVerify">
            <div class="form-group otp-group">
                <label>Verification Code</label>
                <input @bind="_otp" type="text" inputmode="numeric" pattern="[0-9]*"
                       maxlength="6" placeholder="000000" autocomplete="one-time-code" required />
            </div>

            <div class="remember-device">
                <input type="checkbox" id="rememberDevice" @bind="_rememberDevice" />
                <label for="rememberDevice">Trust this device for 30 days</label>
            </div>

            <button type="submit" class="btn-primary" disabled="@_isSubmitting">
                @(_isSubmitting ? "Verifying…" : "Verify")
            </button>
        </form>

        <div class="sso-footer">
            <a href="/login">← Back to Sign In</a> &nbsp;|&nbsp;
            <a @onclick="ResendOtp" href="javascript:void(0)">Resend code</a>
        </div>
    </div>
</div>

